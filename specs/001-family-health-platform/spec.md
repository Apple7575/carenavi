# 기능 명세서: 가족 건강 관리 웹 플랫폼

**기능 브랜치**: `001-family-health-platform`
**작성일**: 2025-11-21
**상태**: 초안
**디자인 참조**: `reference/care99_dashboard/`, `reference/care99_medication_management/`, `reference/care99_vitals_tracking/`

## 사용자 시나리오 및 테스팅 *(필수)*

### 사용자 스토리 1 - 가족 건강 대시보드 조회 (우선순위: P1)

40대 자녀인 가족 관리자가 아침에 로그인하여 부모님과 자녀들의 오늘 건강 상태를 한눈에 확인한다. 복용해야 할 약, 측정해야 할 바이탈(혈압, 혈당), 각 가족 구성원의 건강 점수를 대시보드에서 확인하고, 즉시 조치가 필요한 항목을 파악한다.

**이 우선순위를 선택한 이유**: 대시보드는 사용자가 플랫폼에 접속하여 가장 먼저 보는 화면이며, 모든 주요 정보를 집약하여 보여주는 핵심 기능입니다. 이것만으로도 사용자는 가족의 건강 상태를 모니터링할 수 있어 독립적인 가치를 제공합니다.

**독립 테스트**: 테스트 사용자가 로그인하여 대시보드에 접속하고, 더미 데이터로 채워진 "오늘의 할 일", "가족 개요", "바이탈 요약"을 확인할 수 있으면 완료입니다.

**수락 시나리오**:

1. **Given** 사용자가 로그인한 상태이고, **When** 대시보드 페이지에 접속하면, **Then** 개인화된 인사말("안녕하세요, [사용자 이름]님")이 표시된다
2. **Given** 오늘 복용해야 할 약이 3개 등록되어 있고, **When** 대시보드를 보면, **Then** "오늘의 할 일" 섹션에 3개의 약 복용 체크리스트가 표시된다
3. **Given** 가족 구성원이 3명(부모 2명, 자녀 1명) 등록되어 있고, **When** 대시보드를 보면, **Then** 각 구성원의 건강 점수(0-100)와 상태(좋음/보통/주의필요)가 카드 형태로 표시된다
4. **Given** 최근 7일간의 혈압 데이터가 있고, **When** 대시보드를 보면, **Then** 혈압 추세를 보여주는 라인 차트가 표시된다
5. **Given** 대시보드를 데스크톱에서 보고 있고, **When** 화면을 확인하면, **Then** 왼쪽에 고정된 사이드바 네비게이션이 표시된다
6. **Given** 대시보드를 모바일(iPhone)에서 보고 있고, **When** 화면을 확인하면, **Then** 상단에 햄버거 메뉴가 있는 네비게이션 바가 표시된다

---

### 사용자 스토리 2 - 약물 관리 및 복용 기록 (우선순위: P2)

가족 관리자가 부모님의 복용 약물 목록을 등록하고, 매일 복용 여부를 체크한다. 약물 이름, 복용량, 복용 시간, 복용 요일을 설정하고, 복용했는지 여부를 기록하여 복용 준수율을 추적한다.

**이 우선순위를 선택한 이유**: 약물 관리는 고령 환자 건강 관리의 핵심 기능입니다. 대시보드 다음으로 중요한 기능이며, 복용 준수율 향상이라는 명확한 가치를 제공합니다.

**독립 테스트**: 사용자가 약물을 추가하고, 복용 체크리스트에서 "복용함"을 클릭하여 기록을 남길 수 있으면 완료입니다.

**수락 시나리오**:

1. **Given** 약물 관리 페이지에 접속했고, **When** "약물 추가" 버튼을 클릭하면, **Then** 약물 정보 입력 모달(이름, 복용량, 복용 시간, 요일)이 열린다
2. **Given** 약물 정보를 입력하고, **When** "저장" 버튼을 클릭하면, **Then** 약물 목록에 새 약물이 추가되고 성공 토스트가 표시된다
3. **Given** 등록된 약물이 3개 있고, **When** 약물 관리 페이지를 보면, **Then** 각 약물의 이름, 복용량, 복용 시간이 카드 형태로 표시된다
4. **Given** 오늘 복용해야 할 약이 리스트에 있고, **When** 체크박스를 클릭하면, **Then** "복용함"으로 상태가 변경되고 기록이 저장된다
5. **Given** 최근 30일간의 복용 기록이 있고, **When** 달력 뷰를 보면, **Then** 각 날짜별 복용 준수율이 색상으로 표시된다(초록색: 100%, 노란색: 일부, 빨간색: 미복용)

---

### 사용자 스토리 3 - 바이탈 측정 데이터 기록 및 시각화 (우선순위: P3)

가족 관리자가 부모님의 혈압, 혈당, 체중 데이터를 입력하고, 시간 경과에 따른 추세를 차트로 확인한다. 정상 범위를 벗어나는 수치는 색상으로 강조되어 즉시 알아볼 수 있다.

**이 우선순위를 선택한 이유**: 바이탈 데이터는 건강 상태의 객관적 지표입니다. 약물 관리와 함께 건강 모니터링의 핵심이지만, 초기 MVP에서는 데이터 입력과 기본 시각화만 있어도 가치를 제공합니다.

**독립 테스트**: 사용자가 혈압 데이터를 입력하고, 최근 30일 추세를 라인 차트로 확인할 수 있으면 완료입니다.

**수락 시나리오**:

1. **Given** 바이탈 추적 페이지에 접속했고, **When** "혈압 기록" 버튼을 클릭하면, **Then** 수축기/이완기 혈압 입력 폼이 표시된다
2. **Given** 혈압 값(수축기 120, 이완기 80)을 입력하고, **When** "저장" 버튼을 클릭하면, **Then** 데이터가 저장되고 차트에 새 데이터 포인트가 추가된다
3. **Given** 최근 90일간의 혈압 데이터가 있고, **When** 바이탈 차트를 보면, **Then** 수축기/이완기 혈압이 서로 다른 색상의 라인으로 표시된다
4. **Given** 혈압 수치가 정상 범위를 벗어나고(예: 수축기 150), **When** 차트를 보면, **Then** 해당 데이터 포인트가 빨간색으로 강조 표시된다
5. **Given** 여러 바이탈 데이터(혈압, 혈당, 체중)가 있고, **When** 탭을 전환하면, **Then** 각 바이탈 유형별 차트가 표시된다
6. **Given** 바이탈 데이터가 있고, **When** "데이터 다운로드" 버튼을 클릭하면, **Then** CSV 형식의 파일이 다운로드된다

---

### 사용자 스토리 4 - 가족 구성원 관리 (우선순위: P4)

가족 관리자가 가족 그룹을 생성하고, 구성원을 초대하여 추가한다. 초대 링크 또는 QR 코드를 생성하여 공유하고, 각 구성원의 권한(관리자/편집자/뷰어)을 설정한다.

**이 우선순위를 선택한 이유**: 가족 협업 기능은 중요하지만, 초기 MVP에서는 단일 사용자가 모든 데이터를 관리하는 것으로 시작할 수 있습니다. 이후 확장 기능으로 추가합니다.

**독립 테스트**: 사용자가 가족 구성원을 추가하고, 초대 링크를 생성하여 다른 사용자에게 공유할 수 있으면 완료입니다.

**수락 시나리오**:

1. **Given** 가족 관리 페이지에 접속했고, **When** "구성원 추가" 버튼을 클릭하면, **Then** 이름, 관계(부모/자녀/배우자), 생년월일 입력 폼이 표시된다
2. **Given** 구성원 정보를 입력하고, **When** "저장" 버튼을 클릭하면, **Then** 가족 구성원 목록에 새 구성원이 추가된다
3. **Given** 가족 그룹이 생성되어 있고, **When** "초대 링크 생성" 버튼을 클릭하면, **Then** 고유한 초대 링크가 생성되고 클립보드에 복사된다
4. **Given** 초대 링크가 있고, **When** 다른 사용자가 해당 링크로 접속하면, **Then** 가족 그룹 가입 화면이 표시된다
5. **Given** 여러 구성원이 있고, **When** 각 구성원의 권한을 설정하면, **Then** 관리자/편집자/뷰어 역할이 할당되고 적절한 권한이 부여된다

---

### 사용자 스토리 5 - AI 건강 로드맵 및 리포트 생성 (우선순위: P5)

시스템이 매월 가족 구성원의 건강 데이터를 분석하여 AI 건강 리포트를 생성한다. 리포트는 복용 준수율, 바이탈 추세, 개선 권장사항을 포함하며, PDF로 다운로드하여 의사와 공유할 수 있다.

**이 우선순위를 선택한 이유**: AI 기능은 부가가치가 높지만, 기본 데이터 수집과 시각화가 먼저 구현되어야 합니다. 추후 확장 기능으로 추가합니다.

**독립 테스트**: 시스템이 월간 리포트를 생성하고, 사용자가 리포트를 조회 및 PDF로 다운로드할 수 있으면 완료입니다.

**수락 시나리오**:

1. **Given** 한 달간의 건강 데이터가 축적되어 있고, **When** 월말이 되면, **Then** 시스템이 자동으로 월간 건강 리포트를 생성한다
2. **Given** AI 리포트가 생성되어 있고, **When** 리포트 페이지에 접속하면, **Then** 마크다운 형식으로 렌더링된 리포트가 표시된다
3. **Given** 리포트를 보고 있고, **When** "PDF 다운로드" 버튼을 클릭하면, **Then** 브라우저의 인쇄 기능을 통해 PDF로 저장할 수 있다
4. **Given** 리포트에 여러 섹션(복용 준수율, 바이탈 추세, 권장사항)이 있고, **When** 리포트를 읽으면, **Then** 각 섹션이 명확하게 구분되어 표시된다

---

### 사용자 스토리 6 - 건강 제품 스토어 탐색 (우선순위: P6)

사용자가 건강 관련 제품(혈압계, 체중계, 혈당 측정기 등)을 탐색하고, 제품 상세 정보를 확인한 후 외부 쇼핑몰(쿠팡)로 이동하여 구매한다.

**이 우선순위를 선택한 이유**: 건강 스토어는 수익화 모델이지만, 핵심 건강 관리 기능과는 독립적입니다. 가장 낮은 우선순위로 설정합니다.

**독립 테스트**: 사용자가 제품 목록을 탐색하고, 제품 상세 페이지를 확인한 후 외부 링크로 이동할 수 있으면 완료입니다.

**수락 시나리오**:

1. **Given** 건강 스토어 페이지에 접속했고, **When** 제품 목록을 보면, **Then** 그리드 레이아웃으로 제품 카드(이미지, 이름, 가격)가 표시된다
2. **Given** 제품 필터가 있고, **When** "혈압계" 카테고리를 선택하면, **Then** 해당 카테고리의 제품만 표시된다
3. **Given** 제품 카드를 클릭하고, **When** 상세 페이지로 이동하면, **Then** 제품 설명, 사양, 큰 이미지가 표시된다
4. **Given** 제품 상세 페이지를 보고 있고, **When** "쿠팡에서 구매" 버튼을 클릭하면, **Then** 새 탭에서 쿠팡 제품 페이지가 열린다

---

### Edge Cases

- 가족 구성원이 0명일 때 대시보드는 어떻게 표시되는가? → 빈 상태 일러스트와 "첫 번째 가족 구성원 추가하기" 버튼 표시
- 바이탈 데이터가 없을 때 차트는 어떻게 표시되는가? → "데이터를 입력하여 추세를 확인하세요" 메시지와 "첫 번째 측정 기록" 버튼 표시
- 약물 복용 시간을 잘못 설정했을 때 수정할 수 있는가? → 약물 카드의 편집 아이콘을 클릭하여 수정 가능
- 네트워크 오류로 데이터 저장이 실패했을 때 어떻게 처리하는가? → 에러 토스트 표시 및 재시도 버튼 제공
- 모바일에서 큰 차트를 어떻게 표시하는가? → 스와이프 가능한 가로 스크롤 또는 축소된 뷰 제공
- 동시에 여러 가족 구성원이 같은 데이터를 수정하려고 하면? → 낙관적 UI 업데이트 후 충돌 시 최신 데이터로 리로드

## 요구사항 *(필수)*

### 기능 요구사항

- **FR-001**: 시스템은 사용자가 소셜 로그인(카카오, 구글)을 통해 인증할 수 있어야 한다
- **FR-002**: 시스템은 사용자가 프로필(이름, 역할)을 설정할 수 있어야 한다
- **FR-003**: 시스템은 사용자가 가족 그룹을 생성하거나 기존 그룹에 참여할 수 있어야 한다
- **FR-004**: 시스템은 대시보드에 개인화된 인사말을 표시해야 한다
- **FR-005**: 시스템은 오늘 복용해야 할 약물 목록을 체크리스트 형태로 표시해야 한다
- **FR-006**: 시스템은 가족 구성원별 건강 점수(0-100)와 상태를 표시해야 한다
- **FR-007**: 시스템은 최근 바이탈 데이터를 간단한 차트로 표시해야 한다
- **FR-008**: 시스템은 "바이탈 기록" 및 "약물 기록" 빠른 액션 버튼을 제공해야 한다
- **FR-009**: 사용자는 약물 정보(이름, 복용량, 시간, 요일)를 입력하고 저장할 수 있어야 한다
- **FR-010**: 사용자는 등록된 약물 목록을 조회할 수 있어야 한다
- **FR-011**: 사용자는 약물 복용 여부를 체크하고 기록할 수 있어야 한다
- **FR-012**: 시스템은 약물 복용 준수율을 달력 형태로 시각화해야 한다
- **FR-013**: 사용자는 바이탈 데이터(혈압, 혈당, 체중)를 입력할 수 있어야 한다
- **FR-014**: 시스템은 바이탈 데이터를 시간 경과별 라인 차트로 표시해야 한다
- **FR-015**: 시스템은 정상 범위를 벗어나는 바이탈 수치를 색상으로 강조해야 한다
- **FR-016**: 사용자는 바이탈 데이터를 CSV 파일로 다운로드할 수 있어야 한다
- **FR-017**: 사용자는 가족 구성원을 추가할 수 있어야 한다(이름, 관계, 생년월일)
- **FR-018**: 시스템은 가족 그룹 초대 링크를 생성할 수 있어야 한다
- **FR-019**: 사용자는 가족 구성원의 권한(관리자/편집자/뷰어)을 설정할 수 있어야 한다
- **FR-020**: 시스템은 월간 건강 리포트를 자동으로 생성해야 한다
- **FR-021**: 사용자는 생성된 리포트를 조회하고 PDF로 다운로드할 수 있어야 한다
- **FR-022**: 시스템은 건강 제품 목록을 그리드 레이아웃으로 표시해야 한다
- **FR-023**: 사용자는 제품을 카테고리별로 필터링할 수 있어야 한다
- **FR-024**: 사용자는 제품 상세 정보를 조회하고 외부 쇼핑몰로 이동할 수 있어야 한다
- **FR-025**: 시스템은 데스크톱에서 고정된 왼쪽 사이드바를 표시해야 한다
- **FR-026**: 시스템은 모바일에서 상단 네비게이션 바와 햄버거 메뉴를 표시해야 한다
- **FR-027**: 시스템은 모든 액션(저장, 삭제 등)에 대해 토스트 알림을 표시해야 한다
- **FR-028**: 시스템은 데이터가 없을 때 적절한 빈 상태를 표시해야 한다

### 주요 엔티티

- **사용자 (User)**: 플랫폼을 사용하는 개인. 속성: 이메일, 이름, 역할(가족 관리자/구성원), 프로필 사진
- **가족 그룹 (Family)**: 건강 정보를 공유하는 가족 단위. 속성: 그룹 이름, 초대 코드, 생성 날짜
- **가족 구성원 (FamilyMember)**: 가족 그룹에 속한 개인. 속성: 사용자 ID, 가족 ID, 닉네임, 관계(부모/자녀/배우자), 생년월일, 건강 점수, 권한(관리자/편집자/뷰어)
- **약물 (Medication)**: 복용해야 하는 약물 정보. 속성: 이름, 복용량, 복용 시간(배열), 복용 요일, 알람 설정
- **약물 기록 (MedicationLog)**: 약물 복용 이력. 속성: 약물 ID, 복용 시간, 상태(복용함/건너뜀/놓침), 메모
- **바이탈 (Vital)**: 건강 측정 데이터. 속성: 사용자 ID, 유형(혈압/혈당/체중), 값(JSON), 측정 날짜, 메모
- **건강 리포트 (HealthReport)**: AI 생성 월간 리포트. 속성: 가족 ID, 월(YYYY-MM), 내용(마크다운), 생성 날짜
- **제품 (Product)**: 건강 스토어 제품. 속성: 이름, 설명, 카테고리, 가격, 이미지 URL, 외부 링크
- **할 일 (Task)**: 대시보드의 일일 작업. 속성: 설명, 담당자, 완료 여부, 마감 시간

## 성공 기준 *(필수)*

### 측정 가능한 결과

- **SC-001**: 사용자가 로그인 후 대시보드에서 가족 건강 상태를 5초 이내에 파악할 수 있다
- **SC-002**: 사용자가 약물 복용 여부를 3번의 클릭 이내에 기록할 수 있다
- **SC-003**: 사용자가 바이탈 데이터를 30초 이내에 입력하고 저장할 수 있다
- **SC-004**: 시스템이 1000명의 동시 사용자를 성능 저하 없이 지원할 수 있다
- **SC-005**: 대시보드의 모든 차트와 데이터가 2초 이내에 로드된다
- **SC-006**: 모바일 사용자가 모든 핵심 기능(대시보드, 약물 기록, 바이탈 입력)에 접근할 수 있다
- **SC-007**: 사용자의 95%가 첫 시도에서 주요 작업(약물 추가, 바이탈 기록)을 성공적으로 완료한다
- **SC-008**: 약물 복용 준수율이 플랫폼 사용 후 평균 30% 향상된다(사용자 자가 보고 기준)
- **SC-009**: 사용자가 월간 리포트를 의사에게 제출하여 진료에 활용할 수 있다
- **SC-010**: 플랫폼 사용자의 80%가 매주 최소 3회 이상 로그인하여 데이터를 기록한다

## 디자인 참조

이 기능은 다음 Stitch 참조 디자인을 기반으로 구현됩니다:

- **대시보드**: `reference/care99_dashboard/`
  - 레이아웃: 사이드바 + 그리드 레이아웃(오늘의 할 일, 가족 개요, 바이탈 카드, 빠른 액션)
  - 주요 컴포넌트: Card, Checkbox, Avatar, LineChart, Button
- **약물 관리**: `reference/care99_medication_management/`
  - 레이아웃: 탭(전체/예정/놓침) + 약물 카드 리스트
  - 주요 컴포넌트: Tabs, Card, Badge, Button
- **바이탈 추적**: `reference/care99_vitals_tracking/`
  - 레이아웃: 입력 폼 + 차트 시각화
  - 주요 컴포넌트: Input, LineChart, Card
- **가족 관리**: `reference/care99_family_management/`
  - 레이아웃: 구성원 카드 그리드 + 초대 옵션
  - 주요 컴포넌트: Card, Avatar, Button, Dialog
- **루트 레이아웃**: `reference/care99_root_layout/`
  - 레이아웃: 데스크톱 사이드바 + 모바일 Sheet
  - 주요 컴포넌트: Sidebar, Sheet, Navigation

**중요**: 참조 디자인의 코드를 직접 복사하지 말고, CareNavi 디자인 시스템(Shadcn/UI, Lucide React, CareNavi 컬러 토큰)을 사용하여 재구현해야 합니다.

## 가정 사항

- 사용자는 인터넷 연결이 가능한 환경에서 플랫폼을 사용합니다
- 사용자는 스마트폰 또는 데스크톱 브라우저를 사용합니다(최소 지원: iPhone SE, Chrome/Safari 최신 버전)
- 인증은 Supabase를 통해 처리되며, 소셜 로그인 제공자(카카오, 구글)가 정상 작동합니다
- 바이탈 데이터는 사용자가 직접 측정하여 수동으로 입력합니다(자동 동기화 장치 연동은 추후 확장)
- AI 건강 리포트는 외부 AI API(예: OpenAI)를 통해 생성됩니다
- 건강 스토어의 제품 데이터는 관리자가 수동으로 등록하거나 API를 통해 가져옵니다
- 데이터 보관 기간은 업계 표준(최소 5년)을 따릅니다
- 성능 목표는 표준 웹 애플리케이션 기준(LCP < 2.5s, FID < 100ms)을 따릅니다

## 범위 외

이 명세서에는 다음 기능이 포함되지 **않습니다**:

- 실시간 의료 장비 자동 연동(Bluetooth 혈압계, 혈당계 등)
- 의료진 직접 연결 또는 원격 진료 기능
- 약물 자동 재주문 또는 배송 기능
- 응급 상황 자동 감지 및 알림
- 보험 청구 또는 의료비 관리 기능
- 다국어 지원(초기 버전은 한국어만 지원)
- 오프라인 모드(모든 기능은 인터넷 연결 필요)
